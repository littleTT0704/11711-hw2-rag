-sequencegradient.
Ancestralsamplingdecodesasequencebysamplingauto-
Pooledtasklosses. PGandMRTbothsampleintheaction
regressivelyfromthemodelâ€™sper-stepcategoricaldistribu-
space (i.e. vocabulary), while the proposed MGS samples
tions. Given noise (cid:15) (cid:24) U(0;1), ancestral sampling, which
intheparameterspace.Thisdifferenceaffectstheamount
consistsofrepeatedcategoricalsamplingy^ (cid:24)p ((cid:1)jy^ ;X),
t (cid:18) <t ofsupervisionthatisusedtoweighteachcandidateupdate
canbewrittenasadeterministicfunctionY^ =F anc((cid:18);X;(cid:15)). direction. To see this, consider a minibatch fX ;Y gN.
n n n=1
Thepolicygradientestimatorisanexpectationoverthenoise
The policy gradient estimator with K samples per batch
usedtoproducethecategoricalsamples,
elementis,
rP (cid:18)G =E (cid:15)[c(F anc((cid:18);X;(cid:15));Y)r (cid:18)logp (cid:18)(F anc((cid:18);X;(cid:15)))]: rPG = 1 X c(Y^(k);Y )r logp (Y^(k)jX ); (11)
(cid:18) NK n n (cid:18) (cid:18) n n
Maximum-likelihoodguidedparametersearchusesanyar- n;k
bitrarydecodingalgorithm,e.g.Y^ = F ((cid:18);X),which
greedy whereY^(k)isasampledsequence.Policygradientusesasin-
canbechosentobethesamealgorithmusedatevaluation n
glesequencelosstoweighteachcandidateupdatedirection.
time.TheMGSestimatorisanexpectationovernoiseinthe
AsimilarinspectionrevealsthatMRT