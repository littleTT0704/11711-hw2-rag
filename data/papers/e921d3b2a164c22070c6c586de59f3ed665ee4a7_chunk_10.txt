(p,q)= q(z|x)log
over the possible values of t, and for each t, we perform
q(z|x)
x z the M-step. The best t value is then obtained as the one
(cid:88)(cid:88) p(y|z,x)p(z|x) withmaximumQ-value. Althoughdifferentsamplingstrate-
= q(z|x)log, (9)
q(z|x) giescanbeusedwhensearchingfort,inpracticewefind
x z
grid-searchworkswell.
whereq(z|x)isgivenby(3), andp(y|z,x)isgivenby
(5)(forexample,theleafnodegivesaGaussiandistribution Aswementionedearlier,itisdifficulttoestimatethetrue
overy ifweassumealinearmodelwithGaussiannoise). leafnodeassignmentmassp(z|x). Althoughvariational
Thetrueleafnodeassignmentmassp(z|x)isyetunknown. approximation may be used, we propose an empirically
However,wecanestimateitusingtheempiricalfrequency simplerstrategy. InsteadofusingtheQ-valueasaglobal
of the number of samples at the leaf node over the total indicatoroftheoptimalityofthetree,weproposetousethe
numberoftrainingsamples. Thisisacrudeestimation,but negativemean-square-error
we will provide a better strategy in the later part of this
Q =−mean(y−y)2, (10)
section. alternative (cid:98)
IntheM-step,weoptimizetheparameterstoincreasethe whereyisgivenby(4).
(cid:98)
ELBO (7). Specifically, we optimize the non-leaf node
TherecursiveEMalgorithmissummarizedinAlgorithm1.
experttomaximizetheclassificationaccuracy,andoptimize
Westartfromtherootnode,andgrowthetreerecursively
theleaf-nodeexperttominimizetheregressionerror.
inadepth-firstmanner,i.e.,fromtoptobottom,fromleft
However