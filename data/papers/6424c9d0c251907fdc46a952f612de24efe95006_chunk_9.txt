-
ues,C∗,i.e.,useteacherforcing. However,thisisknownto
3.3.FineLocationDecoder t
sufferfromproblems[40].
The2Dheatmapisusefulforcapturingmultimodaldis-
tributions, but does not give very precise location predic- 3.5.Inference
tions. To overcome this, we train a second convolutional
To generate multiple qualitatively distinct trajectories,
RNNdecoderHOtocomputeanoffsetvectorforeachpos-
t we use the diverse beam search strategy from [25]. To
siblegridcellusingaregressionoutput,O =MLP(HO)∈
t t define this precisely, let B be the beam at time t−1;
RH×W×2. ThisRNNisupdatedusing thissetcontainsK trajectort i− e1 s(historyselections)Mk =
H tO =ConvRNN(GAT(H tO −1),O t−1)∈RH×W×ddec {Yˆk,...,Yˆk }, k ∈ [1,K], where Yˆk is an indext i− n1 G,
1 t−1 t
(5) along with their accumulated log probabilities, Pk. Let
t−1
Tocomputethefinalpredictionlocation,wefirstflattenthe Ck =f(Mk )∈RHW bethecoarselocationoutputprob-
spatialdimensionofO tintoO˜ t ∈RHW×2. Thenweuse abt ilityfromt− E1 q.(2)and(3)attimetgiveninputsM tk −1.
L t =Q i+O˜ ti (6) Thenewbeamiscomputedusing
where i is the index of the selected grid cell, Q ∈ R2 is
i
the center of that cell, and O˜
ti
∈ R2 is the predicted off- B
t
=topK(cid:0) {P tk −1+log(C tk(i))+γ(i)|∀i∈G,k ∈[1,K]}(cid:1)
set for that cell at time t. For single-