
annotations (answer, explanation, etc.) provided in the source datasets. Where
possible, we generate multiple Python programs for a single question. This is to
account for variation in the program space such as the choice of data structure,
language construct, variable name, and programming style (e.g., declarative vs
procedural). For example, Figure 1 gives multiple Python programs solving the
same question; in this case one program directly calculates the answer, whereas
the other defines a function to solve the problem more generally.
Somedatasetscontainprogramannotationsthatcanbecapturedbyadomain-
specifclanguage(DSL)inwhichcasewewriterulestoconvertthemintoPython
programs, e.g., volume(sphere,3) to the Python expression 4/3*math.pi*3**3.
In some cases where a DSL annotation is not provided, we use pattern matching
5
to convert highly templated datasets like the AMPS dataset (Hendrycks et al.,
2021b) to our unified format. In other cases, instead of converting the existing
dataset, we modify the data generation code to reproduce the dataset with
program annotations. For the DeepMind mathematics dataset (Saxton et al.,
2019),thisallowsustocreatediverse,compositionalmathproblemswithprogram
annotations using a sophisticated grammar.
Expert program annotation. Formanydatasets,itisnotpossibletoobtain
Python program annotationsvia automated methods described above; either the
original dataset contains only the final answer or contains solutions expressed in
free-formnaturallanguage. Forsuchdatasets,weobtainannotationsfromexperts
who are proficient in basic programming and high-school level mathematics. See
Appendix B.1 for details.
Instructionannotation. Giventheeffectivenessofinstructionlearning(Mishra
etal.,2022b;Weietal.,2021;Mishraetal.,2022a;Sanhetal.,2021)foreffective
generalization, we collect instruction annotation for each task. Each instruction
contains a definition that clearly defines the task and provides guidelines, a
prompt that provides a short and straight forward instruction, and examples
that facilitate learning by demonstration (Brown et al., 2020). Figure 1 shows
an example