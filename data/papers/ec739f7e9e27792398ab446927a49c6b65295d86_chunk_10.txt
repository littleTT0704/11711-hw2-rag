
Action-selection
Awareness Goal Prediction based Planning
Figure2: Modelarchitecture. Ourframeworkusestheego-centricsequenceofRGBimages,world-framewaypoints,and
theagent’sowncurrentspeedinformationtolearnobstacle-awareattentionmapsandtop-downvisualrepresentations.
These scene encodings inform distribution-aware goal prediction, to leverage expert experience for generalisability to
novelscenarios. Asetofcandidategoalpredictionsarerealisedastrajectories,eachtransformedtotheFrenetroadframe
coordinatesystemandgroundedtovehiclekinematics,usingadifferentiableMPCcontroller. Trajectoriesareprunedusing
alearnablerankingandrefinementmodule.
4.Approach eachsamplecanberegardedasanindependenthypothesis
ofwhatmighthavehappened,giventhesameobservation.
Urbandrivingcanbemodelledasacompositionofdriving
x,u = MPC(x ) is a learning-based
k+1:k+N k+1:k+N goal
primitives, where, through decomposition of the conven-
MPC,whichtakesapredictedgoalfromthegoaldistribu-
tional multimodal perception backbone into hierarchical
tionasinputandgeneratesatrajectorythatreachesx in
goal
unitsandthroughmodulartraining,weenjoylowersample-
N time-stepsbasedonitsembeddedvehiclemodel.
complexityandimprovedrobustnessandgeneralisability,
comparedtoend-to-endpolicies. Ourframeworkusestheego-centricsequenceofRGBim-
ages,world-framewaypoints,andtheagent’sowncurrent
4.1.ProblemFormulation speedinformationtolearnobstacle-awareattentionmaps
andtop-downvisualrepresentations. Thesesceneencod-
WeproposeamodularpipelinethatperformsDistribution- ingsinformourgoalpredictionmodule,whichcombines
awareGoalPrediction,withconformantmodel-basedplan- animitationpriorandagoallikelihoodobjective,inorder
ning, in urban driving settings (DGP). It primarily con- to