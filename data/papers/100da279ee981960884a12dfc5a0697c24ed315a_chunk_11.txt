)−µt)2(cid:17)
, if max(p)<µ,
λ(p)= max − 2σ t2 t (5)
λ, otherwise.
max
whichisalsoatruncatedGaussianfunctionwithintherange[0,λ ],ontheconfidencemax(p).
max
4
PublishedasaconferencepaperatICLR2023
However, the underlying true Gaussian parameters µ and σ are still unknown. Although we can
t t
set the parameters to fixed values as in FixMatch (Sohn et al., 2020) or linearly interpolate them
withinsomepre-definedrangeasinRamp-up(Tarvainen&Valpola,2017),thismightagainover-
simplifythePMFassumptionasdiscussedbefore.RecallthatthePMFλ¯(p)isdefinedovermax(p),
wecaninsteadfit thetruncatedGaussianfunctiondirectlytotheconfidencedistributionforbetter
generalization. Specifically,wecanestimateµandσ2 fromthehistoricalpredictionsofthemodel.
Att-thiteration,wecomputetheempiricalmeanandthevarianceas:
µˆ =Eˆ [max(p)]=
1
(cid:88)BU
max(p ),
b BU B i
U
i=1
(6)
σˆ2 =Vˆar [max(p)]=
1
(cid:88)BU
(max(p ) µˆ )2.
b BU B i − b
U
i=1
Wethenaggregatethebatchstatisticsforamorestableestimation,usingExponentialMovingAv-
erage(EMA)withamomentummoverpreviousbatches:
µˆ =mµˆ +(1 m)µˆ,
t t−1 b
−
B (7)
σˆ2 =mσˆ2 +(1 m) U σˆ2,
t t−1 − B 1 b
U
−
whereweuseunbiasedvarianceforEMAandinitializeµˆ as 1 andσˆ2as1.0. Theestimatedmean