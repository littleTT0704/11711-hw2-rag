and1separately,since
concatenatedandthefinalrepresentationpassesthroughthe theyrepresentdifferentcasesandrestraineachotherwhen
residual block. Later, the generator has a decoder module weconsiderthemtogether. Pleasenotethatwealsocalcu-
toproduceanoutputalphamapbyupsamplingtheresidual latedbothlossesusingalphamatteandforegroundsubjects
output. Finally, 64×64sizeofconsecutivepatchesinthe asintheperceptualloss. Moreover,weproposedtheborder
border of a person’s body are extracted from the predicted loss to penalize the area around the subject. For this, we
alpha matte to enhance the details by the refinement net- generated border maps by applying morphological erosion
work,sincethepredictionstendtohavemoreerrorsaround anddilationoperationsseparately. Then,wesubtractedthe
the body. The generated image is expected to be the fine- eroded segmentation map from the dilated one. The final
grainedalphamatteoftheinputimagefortheportraitmat- map represents the border area of the subject. During the
tingproblem. Besides, theskipconnectionsencouragethe training, we utilized this border map to calculate L1 loss
networktokeepinformationfrombothencoders. for only the corresponding border pixels. The overall loss
Multi-scalediscriminatornetworkForthemulti-scale functionisshowninEquation2
discriminator[45],weprovideanimagepyramidusingthe
originalimageanddownsampledversionsbyafactoroftwo min max (cid:80) (L (G,D )+λL (G)+
k=1,2,3 cGAN k per
and a factor of four to obtain the same image on different G D1,D2,D3
scales. Therefore,thisapproachprovidesustolearnfroma βL alpha(G))+γL border(G)+θL ac(G))
(2)
generalperspectivetofinerdetails,sinceeachdiscriminator
whereL representsconditionaladversarialloss,L
hasadifferentreceptivefield. Pleasenotethatallthreedis- cGAN per
