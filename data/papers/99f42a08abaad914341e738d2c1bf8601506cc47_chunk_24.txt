 SphereFace-R v1 (d) CGD for SphereFace-R v2
stability and its characteristic function is simply a positive
constant with backward gradient as 0. Inspired by such
an observation, we aim to simplify the backward gradient Fig.4.AnillustrationofthebackwardactivationofCGDforSphereFace
(m = 1.4),SphereFace-Rv1(m = 1.4)andSphereFace-Rv2(m =
computation for the characteristic function. To gain more
1.4).ThegreencurvesdemonstratetheeffectofCGDinthebackward
intuitions, we first use Taylor expansion to decompose the propagation, and the forward computation still follows the red curves
characteristic function in the target angular function at an (i.e.,∆(θ))withoutanyapproximation.
arbitraryangleθ
0
∈(0,π)withasmallangledeviationδθ:
ψ(θ +δθ)=η(θ +δθ)−∆(θ +δθ)
0 0 0 propagation. This essentially means that we only need to
=η(θ
+δθ)−(cid:0)
∆(θ )+
∆(cid:48)(θ 0)
δθ+
compute the characteristic function in the forward pass
0 0 1! (13) and completely ignore it in the backward propagation. In
∆(n)(θ ) order to avoid computing the gradient of the characteristic
···+ 0 (δθ)n+R (δθ)(cid:1)
n! n function, we substitute Eq. (16) into the first line of Eq. (5)
andfinallyobtainthefollowinglossfunction:
where ∆(n)(θ) denotes the n-th order derivative of ∆(θ)
andR n(δθ)denotesthehigherorderinfinitesimalof(δθ)n. L
v1
=log(cid:16) 1+(cid:88) exp(cid:0) (cid:107)x(cid:107