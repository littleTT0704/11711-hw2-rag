 giventheintentGenerateHTMLwithpython
syntaxhighlightingfor“print(’readingdocs’)”,theretrieverRretrievesthreerelevantdocuments:
d describesthesyntaxhighlightinglibrarypygments,d describestheclassPythonLexer,and
1 2
d describestheHtmlFormatterclass. Giventhesedocsandtheintent,thegeneratorG generates
3
thecodesnippetc,whichusesPythonLexerandHtmlFormatterfromthepygmentlibrary.
3 PRACTICAL INSTANTIATIONS OF DocPrompting
DocPromptingisageneralapproachthatisnotboundtoanyspecificmodelchoices,anditcanbe
instantiatedwithanybaseretrieverandgenerator. Thissectionpresentstheconcreteinstantiationsof
RandG thatwefoundtoprovidethebestperformanceinourexperiments.
3.1 RETRIEVERINSTANTIATION
Weexperimentwithtwomaintypesofretrievers:sparseretrieversanddenseretrievers. Asoursparse
retriever,weuseElasticsearch2withthestandardBM25(RobertsonandJones,1976). Thisretriever
representsdocumentsusingsparsefeaturesthatrelyonwordfrequencies,suchasBM25andTF-IDF.
Asourdenseretriever,wefollowpriorwork(Chenetal.,2020;Karpukhinetal.,2020;Gaoetal.,
2021): givenatriplet(n,c,D∗),whereD∗ aretheoracledocsforn,eachd+ ∈D∗ andnforma
n n i n
positivepair(n,d+),whileeachd−∉D∗ andnformanegativepair(n,d−). Wetraintheretriever
i j n i j
in a contrastive fashion where the similarity score of a positive pair is maximized while that of
in-batchnegativepairsisminimized. Forapair(n,d+),thelossfunctionisdefinedas:
i i
Lr=−log
exp(sim(h n,h d+ i))
(3)
exp(sim(h n,