Welling, Weaver,1997),whichensuresthatq remainswell-defined
x
2014)toreconstructpixels,speed,andsteeringcontrolin andobtainablethroughachangeofvariables,andensures
thenexttimestepfromcurrentobservations. Itencourages thatp isuniformlydistributedonthesamedomainasthe
z
thelatentvariablestoattendtoobstacleinfrontview(e.g., dataspace(Liao&He,2021)—insofarasbothf andits
vehicles,pedestrians,trafficlights,curbs,etc.)whichimpact inversef−1 aredifferentiableandthatzretainsthesame
futurevehiclecontrol. Thefront-viewfeaturemapf(u,v) dimensionasx:
isconstructedbycombiningthelearnedself-attentionmaps
(Vaswanietal.,2017)withmulti-scaleimagesfeaturesof p x(x)=p z(z)(cid:12) (cid:12)det∂ ∂f z(cid:12) (cid:12)−1 (1)
pre-trained ResNet-18 front-end. Then, voxel-based fea-
turesg(x,y,z)aregeneratedbyaccumulatingimage-based Wecanconstructarbitrarilycomplexdensities,byflowingz
featuresf(u,v)toauniformlyspaced3DlatticeG fixedto alongthepathcreatedbyachainofKsuccessivenormal-
thegroundplaneadistancey pbelowthecameraandhasdi- izingdistributionsp z(z),witheachsuccessivedistribution
mensionsW,H,Dandavoxelresolutionofrusingorthog- governedbyadiffeomorphictransformation:
onaltransformation. Finally,thetopdownimagefeaturerep-
resentationh(x,z)isgeneratedbycollapsingthe3Dvoxel x=z K =f K ◦···◦f 2◦f 1(z 0) (2)
featuremapalongtheverticaldimensionthroughalearned
1Dconvolution. Inadditiontoimagefeatures,weinterpo- Followingthissequenceoftransformations,ourmaininter-
