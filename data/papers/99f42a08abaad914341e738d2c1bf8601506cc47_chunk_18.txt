 k ∈ [0,m − 1] and k is an integer. After ensuring
This serves as an interpolation between no feature normal- η(θ)=cos(θ)andEq.(9),Eq.(5)becomestheobjectivefunc-
ization and hard feature normalization, and can take the tion for the original SphereFace, as summarized in Table 1.
featuremagnitudeintoaccountduringtraining. The original SphereFace requires m to be an integer, which
is in fact unnecessary. m can be any positive value larger
4 SPHEREFACE-R: BETTER AND MORE STABLE than 1. In order to improve training stability, our original
SphereFace minimizes its objective function (with m = 4)
Inthissection,weelaboratethedesignofSphereFace-Rand
jointly with a standard softmax loss, which approximately
introduce two novel variants that perform well in practice.
yields an effective m as 1.4. Therefore, the target angular
Sharing the same geometric interpretation as SphereFace,
functionintheoriginalSphereFacecanbesimplifiedto
SphereFace-R yields improved training stability and supe-
rior open-set generalizability. We start by revisiting the de- (cid:26) cos(mθ) if 0≤θ ≤ π
signoftheoriginalSphereFaceandthenproposealternative ψ(θ)= −cos(mθ)−2 if π <θ ≤m π (10)
m
waystoimplementthemultiplicativemargininSection4.1.
whereweusuallyusem ∈ [1,2].Onecaneasilyverifythat
In Section 4.2, we discuss different feature normalization
the characteristic function ∆(θ) is always larger than zero
schemes.Finally,welistafewimportantopenproblemsfor
with θ ∈ (0,π], so it satisfies the general principle to intro-
hypersphericalFRinSection4.3.
duce large angular margin. Fig. 3 intuitively compares no
angularmargin,additiveangularmarginandmultiplicative
4.1 RethinkingMultiplicativeAngularMargin
angular margin. The intuition of multiplicative margin can
AshasbeenshowninTable1,