 (17)
Moreover,SphereFaceandSphereFace-Rusedifferenteffec-
AfterputtingEq.(17)intothefirstlineofEq.(5),weendup tivemarginparametersforsampleswithdifferenthardness.
with the following general loss function for the cases that Both SphereFace and SphereFace-R strictly satisfy the gen-
modifythenon-targetfunction: eral principle in Eq. (4) to achieve large angular margin,
validatingtheeffectivenessofourproposedprinciple.
(cid:16) (cid:88) (cid:0) (cid:1)(cid:17)
L v2 =log 1+ exp (cid:107)x(cid:107)(ψ(θ i)−ψ(θ y)+Detach(∆(θ i))) Jointlydesigningtargetandnon-targetfunctions.Because
i(cid:54)=y SphereFace-Rv1focusesonthetargetangularfunctionand
SphereFace-Rv2focusesonthenon-targetangularfunction,
from which we can see that the key is to detach the gra-
itisnaturaltoconsidertosimultaneouslydesignthetarget
dients of the characteristic function. Therefore, applying
andnon-targetangularfunctions.Forexample,Eq.(11)and
CGD to SphereFace-R v2 yields the non-target function:
η(θ) = cos(θ)+Detach(cos(θ)−cos(θ)). The essence of Eq.(12)canbeeasilyusedtogetherandtheresultingcharac-
m
teristicfunctionissimplythecombinationofboth.Morein-
CGDistoavoidcomputingthegradientofthecharacteristic
terestingly,itisnotnecessaryforbothtargetandnon-target
function in the backward pass. As a simple generalization,
functionstousethecosine-baseddesign.Wecansimplyuse
we can consider higher-order Taylor approximation to the
a linear function as the target and non-target functions, as
characteristicfunctioninsteadofthezero-orderapproxima-
proposed in [31]. It can effectively alleviate some design
tion.SinceCGDalreadyy