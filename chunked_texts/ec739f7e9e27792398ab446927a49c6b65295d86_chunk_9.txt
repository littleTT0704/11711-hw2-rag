×W×C and a se-
tegrateourperceptionandgoal-predictionmoduleswithan
quence of waypoints ω. Combining X, Φ, and ω we
MPC,inthecontextofurbandriving,enablingoursystem past
havetheagent’sobservation,orsimplyO≡{X,Φ,ω}.
togeneratetrajectoriesthatconformtovehiclekinematics. past
Ateachtime-step,theagentmusttakeanactionu,defined
Trajectoryforecastingforautonomousdriving. Theno- k
asatupleofbraking,throttling,andsteeringcontrol. Our
tionofcharacterisingdistributionsoverallpossibleagent
objective is to learn a parameterised policy π that maps
predictionshasseenexcitinggrowthinthedomainoftrajec- θ
observations to actions u ∼ π (·|O), such that, given a
toryforecastingforautonomousdriving(Leeetal.,2017; θ
sequenceofobservations,anagentthatbeginsatsomeinitial
Rhinehart et al., 2018a;b; 2019; Park et al., 2020; Filos
locationintheenvironmentcandrivetosomedestination.
etal.,2020). WhereasLeeetal.(2017)usepasttrajecto-
riesandscenecontextasinputforpredictingfuturetrajec-
Distribution-awareGoalPredictionandConformantModel-basedPlanningforSafeAutonomousDriving
Environment
Flow Frenet
Waypoints Projection Inverse Inverse
Car Model
Obstacle-
K
Speed a aw ta tere
n
ts ioe nlf - Z(1)
,
Z(2)
,...
Z(k)
Vehicle
M
K oi dn ee lmatics
Action
V Sample Selection
ResNet Backbone Q
Learning-based
Flow Model-predictive
Z Base Complex Control
Distribution Distribution
Top-down
PC roo jn et ce tix ot
n Imitation Prior
T(1)
,
T(2)
,...
T(k)
Obstacle Distribution-aware Conformant Model-