)(η(θ i)−η(θ y)+Detach(∆(θ y)))(cid:1)(cid:17)
When the characteristic function is more complex, then its
i(cid:54)=y
Taylor expansion needs to have more terms to accurately
which can be generally used for the cases where the tar-
representit.Thisleadstomorecomplexbackwardgradient
get angular function is modified, such as SphereFace and
computation. Motivated by the observation that simpler
SphereFace-Rv1.Inthebackwardpass,CGDapproximates
gradientcomputationoftenleadstobettertrainingstability,
thecharacteristicfunctionofthemultiplicativemarginwith
we propose to make an approximation to the characteristic
apiece-wisefunctionconsistingofmanyconstantfunctions,
functionbyremovingsomehigherordertermsinitsTaylor
asillustratedinFig.4.Equivalently,CGDcanalsobeviewed
expansion. Generally, we can remove any higher order
as a step function approximation to the characteristic func-
Taylorexpansiontermsandityieldsdifferentbackwardgra-
tion in the backward pass. We note that the approxima-
dients.Particularly,wedrawinspirationsfromtheconstant
tion in CGD only exists in the backward direction and
characteristicfunctionadoptedinCosFace,andusethezero-
orderapproximationfor∆(θ 0+δθ)inEq.(13): the forward computation is always identical to the CGD-
free scenario. From a different perspective, CGD can be
ψ(θ 0+δθ)≈η(θ 0+δθ)−∆(θ 0) (14) understood as interpreting the multiplicative margin with
a dynamic CosFace-style additive margin (i.e., the effective
whichismuchsimplerandrobusttocomputeandgivesthe
followingapproximategradientforψ(θ)atθ 0: margin parameter for the additive margin is dynamically
dependentontheinputtargetangleinCGDratherthanbe-
ψ(θ +δθ)−ψ(θ )
ψ(cid:48)(