future prediction, we (10)
use greedy search, namely i = argmaxC over the belief
t whereγ(i)isadiversitypenaltyterm,andwetakethetop
state. For multi-future prediction, we use beam search in
K elements from the set produced by considering values
Section3.5.
withk =1:K. IfK =1,thisreducestogreedysearch.
This idea of combining classification and regression is
OncewehavecomputedthetopKfuturepredictions,we
partially inspired by object detection methods (e.g., [41]).
addthecorrespondingoffsetvectorstogetKtrajectoriesby
It is worth noting that in concurrent work, [6] also de- Lk ∈R2. Thisconstitutesthefinaloutputofourmodel.
signed a two-stage model for trajectory forecasting. How- t
ever, their classification targets are pre-defined anchor tra-
4.TheForkingPathsDataset
jectories. Oursisnotlimitedbythepredefinedanchors.
Inthissection, wedescribeourhuman-annotatedsimu-
3.4.Training
lationdataset,calledForkingPaths,formulti-futuretrajec-
Ourmodeltrainsontheobservedtrajectoryfromtime1 toryevaluation.
tohandpredictsthefuturetrajectories(inxy-coordinates)
Existing datasets. There are several real-world datasets
fromtimeh+1toT. Wesupervisethistrainingbyprovid-
fortrajectoryevaluation,suchasSDD[46],ETH/UCY[37,
inggroundtruthtargetsforboththeheatmap(beliefstate),
24], KITTI [13], nuScenes [5] and VIRAT/ActEV [3, 36].
C∗, and regression offset map, O∗. In particular, for the
t t However, they all share the fundamental problem that one
coarsedecoder,thecross-entropylossisused:
can only observe one out of many possible future trajec-
1 (cid:88)T (cid:88) tories sampled from the underlying distribution. This is
L =−