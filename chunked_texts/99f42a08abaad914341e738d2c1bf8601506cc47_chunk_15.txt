function∆(·),thefeaturemag- multi-classscenario,asshownin
nitude (cid:107)x(cid:107) in Eq. (5) also plays a non-negligible role in (cid:16) (cid:88) (cid:0) (cid:1)(cid:17)
lim log 1+ exp s(η(θ )−η(θ )+∆(θ ))
i y y
learninglargeangularmargin.TheoriginalSphereFaceap- s→+∞
i(cid:54)=y
proach preserves the feature magnitude in training, since (cid:26) (8)
the feature magnitude does not affect the angular decision =
0 if ∀i(cid:54)=y, η(θ y)−η(θ i)>∆(θ y)
boundary. [3], [4], [5], [9], [29] show that normalizing the
+∞ if ∃i(cid:54)=y, η(θ y)−η(θ i)<∆(θ y)
featuremagnitudetoaconstants(e.g.,makingx←s x in where s has a large influence on the loss value. For the
(cid:107)x(cid:107)
Eq.(5))canstabilizetrainingandalsoimprovehyperspher- multi-class scenario, the neural network can trivially in-
)( noitcnuF
citsiretcarahC
)( noitcnuF
citsiretcarahC
eulaV noitcnuF
evitcejbO
eulaV noitcnuF
evitcejbO
IEEETRANSACTIONSONPATTERNANALYSISANDMACHINEINTELLIGENCE 5
c ar llea is (cid:54)=es yt.o Inm tein reim sti iz ne glt yh,e thlo isss ao lsn oce exη p(θ lay i) n−
s
wη( hθ yi) t> he